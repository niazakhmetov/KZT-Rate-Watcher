
name: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ö—É—Ä—Å–æ–≤ (CDI)

# –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç, –∫–æ–≥–¥–∞ —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω
on:
  # üí• –ó–∞–º–µ–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö CI-—Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ (push/pull_request)
  # –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
  # –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 07:00 UTC+5 (02:00 UTC).
  schedule:
    - cron: '0 2 * * *' 
  
  # –ü–æ–∑–≤–æ–ª—è–µ—Ç –í–∞–º –∑–∞–ø—É—Å—Ç–∏—Ç—å —ç—Ç–æ—Ç —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –≤–∫–ª–∞–¥–∫—É Actions
  workflow_dispatch:

# –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –æ–¥–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
jobs:
  # –ù–∞–∑—ã–≤–∞–µ–º –∑–∞–¥–∞–Ω–∏–µ 'update-data' –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ 'build'
  update-data:
    # –¢–∏–ø —Ä–∞–Ω–Ω–µ—Ä–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–æ –∑–∞–¥–∞–Ω–∏–µ
    runs-on: ubuntu-latest
    
    # üí• –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –∑–∞–ø–∏—Å—å –¥–ª—è GITHUB_TOKEN (—Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É 403)
    permissions:
      contents: write 
      pull-requests: read
      
    # –®–∞–≥–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á
    steps:
      # –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ: uses: actions/checkout@v4)
      - name: 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }} 

      # –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Python
      - name: 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Python 3.x
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'
          
      # –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ: Run a one-line script)
      - name: 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (requests)
        run: pip install -r requirements.txt
        
      # –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ (–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞)
      - name: 4. –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –ù–ë–ö
        run: python src/parser_script.py
        
      # –®–∞–≥ 5: –ö–æ–º–º–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ JSON (–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ: Run a multi-line script - –¥–ª—è –¥–µ–ø–ª–æ—è)
      - name: 5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–º–º–∏—Ç –∏ –ø—É—à –¥–∞–Ω–Ω—ã—Ö
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_user_name: KZT Rates Bot
          commit_user_email: actions-bot@github.com
          commit_message: 'ü§ñ Automated: Update KZT exchange rates data'
          file_pattern: 'data/latest_rates.json'
